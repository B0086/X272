using System;
using System.Net;

class Program
{
    static void Main(string[] args)
    {
        string originalUrl = "http://45.13.227.206";
        string redirectUrl = "http://185.205.19.150";

        HttpListener listener = new HttpListener();
        listener.Prefixes.Add(originalUrl + "/");
        
        try
        {
            listener.Start();
            Console.WriteLine("Listening for requests...");

            while (true)
            {
                HttpListenerContext context = listener.GetContext();
                ThreadPool.QueueUserWorkItem((state) =>
                {
                    HttpListenerRequest request = context.Request;
                    HttpListenerResponse response = context.Response;

                    // Yönlendirme işlemi
                    if (request.Url.AbsoluteUri.StartsWith(originalUrl))
                    {
                        string newUrl = redirectUrl + request.Url.AbsolutePath;
                        response.StatusCode = (int)HttpStatusCode.Found;
                        response.Redirect(newUrl);
                        Console.WriteLine($"Redirected: {request.Url.AbsoluteUri} to {newUrl}");
                    }
                    else
                    {
                        response.StatusCode = (int)HttpStatusCode.NotFound;
                    }

                    response.Close();
                });
            }
        }
        catch (HttpListenerException ex)
        {
            Console.WriteLine($"HttpListenerException occurred: {ex.Message}");
        }
        finally
        {
            listener.Stop();
        }
    }
}
